"use client";

import React from "react";
import Link from "next/link";
import { usePathname } from "next/navigation";

import { api } from "~/trpc/react";
import UserButton from "./UserButton";

interface SidebarProps {
  children?: React.ReactNode;
}

const Sidebar: React.FC<SidebarProps> = () => {
  const path = usePathname();
  const urlParts = path.split("/");
  const projectid = urlParts[urlParts.indexOf("dashboard") + 1];
  const { data: found } = api.projects.existsFromCurrentUser.useQuery(
    projectid ?? "",
  );

  const LinkElement = found
    ? Link
    : (props: Record<string, unknown>) => <div {...props} />;

  return (
    <div className="flex flex-col space-y-8 text-white">
      <div>
        <UserButton projectid={found ? projectid : undefined} />
      </div>

      <hr className="pointer-events-none h-[0.1rem] w-full rounded-full bg-white" />

      <div className={`${found ? "" : "opacity-30"} flex flex-col space-y-2`}>
        <div className="flex">
          <LinkElement href={`/dashboard/${projectid}/`} className="flex">
            <div className="flex items-center space-x-3 rounded-full px-8 py-1">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="17"
                height="15"
                viewBox="0 0 17 15"
                className="h-5 w-5 pb-0.5"
                fill="none"
              >
                <path
                  d="M6.29812 13.6981V9.32312H9.79812V13.6981C9.79812 14.1794 10.1919 14.5731 10.6731 14.5731H13.2981C13.7794 14.5731 14.1731 14.1794 14.1731 13.6981V7.57312H15.6606C16.0631 7.57312 16.2556 7.07437 15.9494 6.81187L8.63437 0.223125C8.30187 -0.074375 7.79437 -0.074375 7.46187 0.223125L0.14687 6.81187C-0.15063 7.07437 0.0331204 7.57312 0.43562 7.57312H1.92312V13.6981C1.92312 14.1794 2.31687 14.5731 2.79812 14.5731H5.42312C5.90437 14.5731 6.29812 14.1794 6.29812 13.6981Z"
                  fill="white"
                />
              </svg>
              <span>Home</span>
            </div>
          </LinkElement>
        </div>
        <div className="flex">
          <LinkElement href={`/dashboard/${projectid}/files`} className="flex">
            <div className="flex items-center space-x-3 rounded-full px-8 py-1">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="15"
                height="16"
                viewBox="0 0 15 16"
                className="h-5 w-5 pb-0.5"
                fill="none"
              >
                <path
                  d="M2.92958 15.073C2.52681 15.073 2.16917 14.9411 1.85667 14.6772C1.54417 14.4133 1.3532 14.08 1.28376 13.6772L0.012931 6.05226C-0.0287355 5.80226 0.030292 5.57656 0.190013 5.37518C0.349735 5.17379 0.561539 5.07309 0.825427 5.07309H13.867C14.1309 5.07309 14.3427 5.17379 14.5024 5.37518C14.6622 5.57656 14.7212 5.80226 14.6795 6.05226L13.4087 13.6772C13.3393 14.08 13.1483 14.4133 12.8358 14.6772C12.5233 14.9411 12.1656 15.073 11.7629 15.073H2.92958ZM5.67957 10.0731H9.01289C9.24899 10.0731 9.44691 9.99321 9.60663 9.83349C9.76635 9.67377 9.84621 9.47585 9.84621 9.23974C9.84621 9.00363 9.76635 8.80571 9.60663 8.64599C9.44691 8.48627 9.24899 8.40641 9.01289 8.40641H5.67957C5.44346 8.40641 5.24554 8.48627 5.08582 8.64599C4.9261 8.80571 4.84624 9.00363 4.84624 9.23974C4.84624 9.47585 4.9261 9.67377 5.08582 9.83349C5.24554 9.99321 5.44346 10.0731 5.67957 10.0731ZM2.34625 4.23977C2.11014 4.23977 1.91223 4.1599 1.75251 4.00018C1.59278 3.84046 1.51292 3.64255 1.51292 3.40644C1.51292 3.17033 1.59278 2.97241 1.75251 2.81269C1.91223 2.65297 2.11014 2.57311 2.34625 2.57311H12.3462C12.5823 2.57311 12.7802 2.65297 12.9399 2.81269C13.0997 2.97241 13.1795 3.17033 13.1795 3.40644C13.1795 3.64255 13.0997 3.84046 12.9399 4.00018C12.7802 4.1599 12.5823 4.23977 12.3462 4.23977H2.34625ZM4.01291 1.73978C3.7768 1.73978 3.57889 1.65992 3.41916 1.5002C3.25944 1.34047 3.17958 1.14256 3.17958 0.906449C3.17958 0.670339 3.25944 0.472424 3.41916 0.312702C3.57889 0.152981 3.7768 0.0731201 4.01291 0.0731201H10.6795C10.9157 0.0731201 11.1136 0.152981 11.2733 0.312702C11.433 0.472424 11.5129 0.670339 11.5129 0.906449C11.5129 1.14256 11.433 1.34047 11.2733 1.5002C11.1136 1.65992 10.9157 1.73978 10.6795 1.73978H4.01291Z"
                  fill="white"
                />
              </svg>
              <span>Files</span>
            </div>
          </LinkElement>
        </div>
        <div className="flex">
          <LinkElement href={`/dashboard/${projectid}/keys`} className="flex">
            <div className="flex items-center space-x-3 rounded-full px-8 py-1">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="9"
                viewBox="0 0 16 9"
                fill="none"
                className="h-5 w-5 pb-0.5"
              >
                <path
                  d="M6.375 4.32312C6.375 3.73284 6.1684 3.23111 5.75521 2.81791C5.34201 2.40472 4.84028 2.19812 4.25 2.19812C3.65972 2.19812 3.15799 2.40472 2.74479 2.81791C2.3316 3.23111 2.125 3.73284 2.125 4.32312C2.125 4.9134 2.3316 5.41513 2.74479 5.82833C3.15799 6.24152 3.65972 6.44812 4.25 6.44812C4.84028 6.44812 5.34201 6.24152 5.75521 5.82833C6.1684 5.41513 6.375 4.9134 6.375 4.32312ZM15.3177 4.30541C15.3177 4.39986 15.303 4.4884 15.2734 4.57104C15.2439 4.65368 15.1997 4.73041 15.1406 4.80124L13.5469 6.6252C13.4878 6.69604 13.42 6.75211 13.3432 6.79343C13.2665 6.83475 13.1809 6.86131 13.0865 6.87312C12.992 6.88493 12.9005 6.87607 12.812 6.84656C12.7234 6.81704 12.6437 6.77277 12.5729 6.71375L11.3333 5.73979L10.4125 6.66062C10.3417 6.73145 10.2649 6.78163 10.1823 6.81114C10.0997 6.84065 10.0111 6.85541 9.91667 6.85541C9.82222 6.85541 9.73368 6.84065 9.65104 6.81114C9.5684 6.78163 9.49167 6.73145 9.42083 6.66062L8.5 5.73979H8.25208C7.95694 6.58979 7.4434 7.27451 6.71146 7.79395C5.97951 8.3134 5.15903 8.57312 4.25 8.57312C3.06944 8.57312 2.06597 8.15993 1.23958 7.33354C0.413194 6.50715 0 5.50368 0 4.32312C0 3.14256 0.413194 2.13909 1.23958 1.3127C2.06597 0.486315 3.06944 0.0731201 4.25 0.0731201C5.20625 0.0731201 6.04149 0.344647 6.75573 0.887703C7.46997 1.43076 7.96875 2.10368 8.25208 2.90645H13.8833C13.9778 2.90645 14.0693 2.92416 14.1578 2.95958C14.2464 2.995 14.326 3.04812 14.3969 3.11895L15.1229 3.845C15.1819 3.90402 15.2292 3.9719 15.2646 4.04864C15.3 4.12538 15.3177 4.21097 15.3177 4.30541Z"
                  fill="white"
                />
              </svg>
              <span>Keys</span>
            </div>
          </LinkElement>
        </div>
        <div className="flex">
          <LinkElement
            href={`/dashboard/${projectid}/settings`}
            className="flex"
          >
            <div className="flex items-center space-x-3 rounded-full px-8 py-1">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="15"
                height="16"
                viewBox="0 0 15 16"
                className="h-5 w-5 pb-0.5"
                fill="none"
              >
                <path
                  d="M5.96452 15.1567C5.77506 15.1567 5.61086 15.0936 5.47193 14.9673C5.33299 14.841 5.25089 14.6831 5.22563 14.4936L4.99828 12.7317C4.83408 12.6685 4.67936 12.5927 4.5341 12.5043C4.38885 12.4159 4.24676 12.3212 4.10782 12.2201L2.45953 12.9022C2.2827 12.978 2.10587 12.9874 1.92904 12.9306C1.75221 12.8738 1.61327 12.7632 1.51223 12.599L0.110231 10.155C0.0091859 9.99082 -0.0223906 9.81399 0.0155012 9.62453C0.0533931 9.43507 0.148123 9.2835 0.29969 9.16983L1.72063 8.08991C1.708 8.0015 1.70169 7.91624 1.70169 7.83414V7.3226C1.70169 7.2405 1.708 7.15524 1.72063 7.06683L0.29969 5.98691C0.148123 5.87324 0.0533931 5.72167 0.0155012 5.53221C-0.0223906 5.34275 0.0091859 5.16592 0.110231 5.00172L1.51223 2.5577C1.61327 2.3935 1.75221 2.28298 1.92904 2.22615C2.10587 2.16931 2.2827 2.17878 2.45953 2.25457L4.10782 2.93662C4.24676 2.83557 4.39201 2.74084 4.54358 2.65243C4.69514 2.56401 4.84671 2.48823 4.99828 2.42508L5.22563 0.663107C5.25089 0.473648 5.33299 0.315765 5.47193 0.189459C5.61086 0.0631531 5.77506 0 5.96452 0H8.80641C8.99587 0 9.16007 0.0631531 9.299 0.189459C9.43794 0.315765 9.52004 0.473648 9.5453 0.663107L9.77265 2.42508C9.93685 2.48823 10.0916 2.56401 10.2368 2.65243C10.3821 2.74084 10.5242 2.83557 10.6631 2.93662L12.3114 2.25457C12.4882 2.17878 12.6651 2.16931 12.8419 2.22615C13.0187 2.28298 13.1577 2.3935 13.2587 2.5577L14.6607 5.00172C14.7617 5.16592 14.7933 5.34275 14.7554 5.53221C14.7175 5.72167 14.6228 5.87324 14.4712 5.98691L13.0503 7.06683C13.0629 7.15524 13.0692 7.2405 13.0692 7.3226V7.83414C13.0692 7.91624 13.0566 8.0015 13.0314 8.08991L14.4523 9.16983C14.6039 9.2835 14.6986 9.43507 14.7365 9.62453C14.7744 9.81399 14.7428 9.99082 14.6418 10.155L13.2398 12.5801C13.1387 12.7443 12.9966 12.858 12.8135 12.9211C12.6303 12.9843 12.4503 12.978 12.2735 12.9022L10.6631 12.2201C10.5242 12.3212 10.3789 12.4159 10.2274 12.5043C10.0758 12.5927 9.92422 12.6685 9.77265 12.7317L9.5453 14.4936C9.52004 14.6831 9.43794 14.841 9.299 14.9673C9.16007 15.0936 8.99587 15.1567 8.80641 15.1567H5.96452ZM7.42336 10.2308C8.15593 10.2308 8.78115 9.97187 9.299 9.45402C9.81686 8.93616 10.0758 8.31095 10.0758 7.57837C10.0758 6.84579 9.81686 6.22058 9.299 5.70272C8.78115 5.18487 8.15593 4.92594 7.42336 4.92594C6.67815 4.92594 6.04978 5.18487 5.53824 5.70272C5.0267 6.22058 4.77093 6.84579 4.77093 7.57837C4.77093 8.31095 5.0267 8.93616 5.53824 9.45402C6.04978 9.97187 6.67815 10.2308 7.42336 10.2308Z"
                  fill="white"
                />
              </svg>
              <span>Settings</span>
            </div>
          </LinkElement>
        </div>
      </div>

      <hr className="h-[0.1rem] w-full rounded-full bg-white" />

      <div className="flex flex-col space-y-2">
        <div className="flex">
          <Link href="/dashboard/organizations" className="flex">
            <div className="flex items-center space-x-3 rounded-full px-8 py-1">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="17"
                viewBox="0 0 16 17"
                className="h-5 w-5 pb-0.5"
                fill="none"
              >
                <path
                  d="M2.59875 14.5341V1.36582C2.59875 1.1638 2.76252 1.00003 2.96454 1.00003H8.63424C8.83626 1.00003 9.00003 1.1638 9.00003 1.36582V14.5342C9.00003 14.7362 8.83626 14.8999 8.63424 14.8999H2.96454C2.76252 14.8999 2.59875 14.7362 2.59875 14.5341Z"
                  fill="white"
                  stroke="white"
                  strokeWidth="0.977102"
                />
                <rect
                  x="3.57288"
                  y="5.40231"
                  width="1.76755"
                  height="2.12106"
                  rx="0.176755"
                  fill="#2C2C2C"
                />
                <rect
                  x="6.22424"
                  y="5.40227"
                  width="1.76755"
                  height="2.12106"
                  rx="0.176755"
                  fill="#2C2C2C"
                />
                <rect
                  x="3.57288"
                  y="2.00003"
                  width="1.76755"
                  height="2.87226"
                  rx="0.176755"
                  fill="#2C2C2C"
                />
                <rect
                  x="6.22424"
                  y="2.00003"
                  width="1.76755"
                  height="2.87226"
                  rx="0.176755"
                  fill="#2C2C2C"
                />
                <rect
                  x="3.57288"
                  y="9.88246"
                  width="2.17748"
                  height="4"
                  rx="0.176032"
                  fill="#2C2C2C"
                />
                <path
                  d="M6.94904 10V14.6001C6.94904 15.4156 7.61009 16.0766 8.42554 16.0766H13.0256C13.8411 16.0766 14.5021 15.4156 14.5021 14.6001V10C14.5021 9.18458 13.8411 8.52353 13.0256 8.52353H8.42554C7.61009 8.52353 6.94904 9.18458 6.94904 10Z"
                  fill="white"
                  stroke="#2C2C2C"
                  strokeWidth="0.952992"
                />
                <path
                  d="M8.65002 10.16C8.65002 10.0716 8.72166 9.99997 8.81002 9.99997H10.1237C10.2142 9.99997 10.2875 10.0733 10.2875 10.1637V11.4737C10.2875 11.5641 10.2142 11.6374 10.1237 11.6374H8.81377C8.72334 11.6374 8.65002 11.5641 8.65002 11.4737V10.16Z"
                  fill="#2C2C2C"
                />
                <path
                  d="M11.1063 10.16C11.1063 10.0716 11.178 9.99997 11.2663 9.99997H12.58C12.6705 9.99997 12.7438 10.0733 12.7438 10.1637V11.4737C12.7438 11.5641 12.6705 11.6374 12.58 11.6374H11.2701C11.1796 11.6374 11.1063 11.5641 11.1063 11.4737V10.16Z"
                  fill="#2C2C2C"
                />
                <path
                  d="M8.65002 12.4523C8.65002 12.3639 8.72166 12.2923 8.81002 12.2923H10.1237C10.2142 12.2923 10.2875 12.3656 10.2875 12.456V13.766C10.2875 13.8564 10.2142 13.9297 10.1237 13.9297H8.81377C8.72334 13.9297 8.65002 13.8564 8.65002 13.766V12.4523Z"
                  fill="#2C2C2C"
                />
                <path
                  d="M11.1063 12.4523C11.1063 12.3639 11.178 12.2923 11.2663 12.2923H12.58C12.6705 12.2923 12.7438 12.3656 12.7438 12.456V13.766C12.7438 13.8564 12.6705 13.9297 12.58 13.9297H11.2701C11.1796 13.9297 11.1063 13.8564 11.1063 13.766V12.4523Z"
                  fill="#2C2C2C"
                />
                <path
                  d="M1 15.45L15 15.45"
                  stroke="white"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                />
              </svg>
              <span>Organizations</span>
            </div>
          </Link>
        </div>
        <div className="flex">
          <Link href="/dashboard/projects" className="flex">
            <div className="flex items-center space-x-3 rounded-full px-8 py-1">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="15"
                height="15"
                className="h-5 w-5 pb-0.5"
                viewBox="0 0 15 15"
                fill="none"
              >
                <rect
                  x="4.50006"
                  y="6.00003"
                  width="9"
                  height="3.75"
                  rx="0.75"
                  fill="white"
                  stroke="#2C2C2C"
                  strokeWidth="0.75"
                />
                <path
                  d="M4.5 10.5H8.25V6.75H4.5V10.5ZM4.5 5.25H13.5V1.5H4.5V5.25ZM9.75 10.5H13.5V6.75H9.75V10.5ZM4.5 12C4.0875 12 3.73438 11.8531 3.44063 11.5594C3.14688 11.2656 3 10.9125 3 10.5V1.5C3 1.0875 3.14688 0.734375 3.44063 0.440625C3.73438 0.146875 4.0875 0 4.5 0H13.5C13.9125 0 14.2656 0.146875 14.5594 0.440625C14.8531 0.734375 15 1.0875 15 1.5V10.5C15 10.9125 14.8531 11.2656 14.5594 11.5594C14.2656 11.8531 13.9125 12 13.5 12H4.5ZM1.5 15C1.0875 15 0.734375 14.8531 0.440625 14.5594C0.146875 14.2656 0 13.9125 0 13.5V3.75C0 3.5375 0.071875 3.35938 0.215625 3.21562C0.359375 3.07187 0.5375 3 0.75 3C0.9625 3 1.14062 3.07187 1.28437 3.21562C1.42813 3.35938 1.5 3.5375 1.5 3.75V13.5H11.25C11.4625 13.5 11.6406 13.5719 11.7844 13.7156C11.9281 13.8594 12 14.0375 12 14.25C12 14.4625 11.9281 14.6406 11.7844 14.7844C11.6406 14.9281 11.4625 15 11.25 15H1.5Z"
                  fill="white"
                />
                <rect x="4" y="1" width="10" height="10" fill="white" />
                <rect
                  x="4.89001"
                  y="1.77"
                  width="8.245"
                  height="3.33333"
                  rx="0.666667"
                  fill="white"
                  stroke="#2C2C2C"
                />
                <rect
                  x="4.94"
                  y="7.02"
                  width="3.25006"
                  height="3.25006"
                  rx="0.650012"
                  fill="white"
                  stroke="#2C2C2C"
                />
                <rect
                  x="9.85999"
                  y="7.02"
                  width="3.25006"
                  height="3.25006"
                  rx="0.650012"
                  fill="white"
                  stroke="#2C2C2C"
                />
              </svg>
              <span>Projects</span>
            </div>
          </Link>
        </div>
        <div className="flex">
          <Link href="/dashboard/pricing" className="flex">
            <div className="flex items-center space-x-3 rounded-full px-8 py-1">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="12"
                viewBox="0 0 16 12"
                className="h-5 w-5 pb-0.5"
                fill="none"
              >
                <path
                  d="M1.40909 11.2727C1.02159 11.2727 0.689867 11.1348 0.41392 10.8588C0.137974 10.5829 0 10.2511 0 9.86364V2.81818C0 2.61856 0.0675189 2.45123 0.202557 2.31619C0.337595 2.18116 0.504924 2.11364 0.704545 2.11364C0.904167 2.11364 1.0715 2.18116 1.20653 2.31619C1.34157 2.45123 1.40909 2.61856 1.40909 2.81818V9.86364H12.6818C12.8814 9.86364 13.0488 9.93116 13.1838 10.0662C13.3188 10.2012 13.3864 10.3686 13.3864 10.5682C13.3864 10.7678 13.3188 10.9351 13.1838 11.0702C13.0488 11.2052 12.8814 11.2727 12.6818 11.2727H1.40909ZM4.22727 8.45455C3.83977 8.45455 3.50805 8.31657 3.2321 8.04062C2.95616 7.76468 2.81818 7.43295 2.81818 7.04545V1.40909C2.81818 1.02159 2.95616 0.689867 3.2321 0.41392C3.50805 0.137974 3.83977 0 4.22727 0H14.0909C14.4784 0 14.8101 0.137974 15.0861 0.41392C15.362 0.689867 15.5 1.02159 15.5 1.40909V7.04545C15.5 7.43295 15.362 7.76468 15.0861 8.04062C14.8101 8.31657 14.4784 8.45455 14.0909 8.45455H4.22727ZM5.63636 7.04545C5.63636 6.65795 5.49839 6.32623 5.22244 6.05028C4.9465 5.77434 4.61477 5.63636 4.22727 5.63636V7.04545H5.63636ZM12.6818 7.04545H14.0909V5.63636C13.7034 5.63636 13.3717 5.77434 13.0957 6.05028C12.8198 6.32623 12.6818 6.65795 12.6818 7.04545ZM9.15909 6.34091C9.74621 6.34091 10.2453 6.13542 10.6562 5.72443C11.0672 5.31345 11.2727 4.81439 11.2727 4.22727C11.2727 3.64015 11.0672 3.1411 10.6562 2.73011C10.2453 2.31913 9.74621 2.11364 9.15909 2.11364C8.57197 2.11364 8.07292 2.31913 7.66193 2.73011C7.25095 3.1411 7.04545 3.64015 7.04545 4.22727C7.04545 4.81439 7.25095 5.31345 7.66193 5.72443C8.07292 6.13542 8.57197 6.34091 9.15909 6.34091ZM4.22727 2.81818C4.61477 2.81818 4.9465 2.68021 5.22244 2.40426C5.49839 2.12831 5.63636 1.79659 5.63636 1.40909H4.22727V2.81818ZM14.0909 2.81818V1.40909H12.6818C12.6818 1.79659 12.8198 2.12831 13.0957 2.40426C13.3717 2.68021 13.7034 2.81818 14.0909 2.81818Z"
                  fill="white"
                />
              </svg>
              <span>Pricing & Billing</span>
            </div>
          </Link>
        </div>
      </div>
    </div>
  );
};

export default Sidebar;
